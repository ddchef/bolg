---
title: vue嵌套iframe导致回退按钮无效
---
## 问题起因
今天测试突然提了一个问题，线上的产品出现了一个问题，点击回退按钮，iframe内部分的页面变化了，但是外部的菜单和路由没有变化。
## 复现
收到这个问题之后，我在本地修改了mock数据，复现了线上的这个问题。
## 调试
开始我以为是 router 的beforeEach的内部逻辑出现了问题，所以在内部打了一个断点，发现在点击回退按钮的时候并没有进入这个beforeEach。
所以就排除 beforeEach 的问题，那么大概率是没有触发 router。
## 猜测
既然浏览器的回退按钮点击了确实触发了iframe的变化，那么会不会是iframe本身的问题了。我大概看了下这个iframe页面，发现又好多需要嵌套的也页面，用的都是这个页面。是不是觉得有点不太对劲，重点来了，**都是用了同一个组件**，那么，vue的组件复用就会导致这个组件不会重新执行声明周期，只是修改了一个src，就导致了iframe有了history。
## 解决
既然是复用引起的，那么加个key就能解决了，解决方案如下
```vue {2,8}
<template>
  <iframe :key="id" :src="src"/>
</template>
<script>
export default {
  computed:{
    id(){
      return Symbol(this.src) // 利用Symbol的唯一性
    }
  }
}
</script>
```
## 总结
遇到这种情况，真的没有想法的时候，只能靠积累的知识进行大胆的猜想。然后慢慢的去排除一些可能，最后留下的就是解决方案了。